---
import { SITE } from "@config";
import Footer from "@components/Footer.astro";
import Header from "@components/Header.astro";
import Layout from "./Layout.astro";

export interface Props {
  // allow either plain props...
  title?: string;
  description?: string;
  // ...or a legacy frontmatter object
  frontmatter?: {
    title: string;
    description?: string;
  };
}

const { title, description, frontmatter } = Astro.props;

// Resolve final title/description from either shape
const pageTitle = (title ?? frontmatter?.title ?? "Doctoral Thesis");
const pageDesc  = (description ?? frontmatter?.description ?? "PhD thesis — details and abstract");
---

<Layout title={`${pageTitle} | ${SITE.title}`} description={pageDesc}>
  <Header activeNav="thesis" />
  <main id="main-content" class="mx-auto max-w-5xl px-4 sm:px-6 py-8 sm:py-12">
    <!-- Title / Hero -->
    <header class="mb-8 sm:mb-10">
      <h1
        class="text-4xl sm:text-5xl font-extrabold tracking-tight 
               bg-gradient-to-r from-sky-500 to-fuchsia-500 bg-clip-text text-transparent">
        {pageTitle}
      </h1>
      {pageDesc && (
        <p class="mt-3 text-sm sm:text-base text-skin-muted">{pageDesc}</p>
      )}
    </header>

    <!-- 2-column split: LEFT meta card | RIGHT abstract card -->
    <section class="grid gap-6 lg:grid-cols-5 mb-10">
      <!-- (1) + (2): CARD — metadata -->
      <aside class="lg:col-span-2 rounded-3xl border border-skin-line/40 bg-skin-card/80 shadow-lg">
        <div class="p-5 sm:p-6">
          <slot name="meta" />
        </div>
      </aside>

      <!-- (1) + (2): CARD — abstract with serif typography -->
      <article class="lg:col-span-3 rounded-3xl border border-skin-line/40 bg-skin-card/80 shadow-lg">
        <div class="p-5 sm:p-6 prose prose-neutral dark:prose-invert max-w-none">
          <div class="font-serif not-prose">
            <h2 class="text-xl sm:text-2xl font-semibold mb-3">Abstract</h2>
          </div>
          <div class="font-serif leading-relaxed">
            <slot name="abstract" />
          </div>
        </div>
      </article>
    </section>

    <!-- (3) Timeline / milestones -->
    <section class="mb-10 rounded-3xl border border-skin-line/40 bg-skin-card/80 shadow-lg">
      <div class="p-5 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-semibold mb-4">Milestones</h2>
        <div class="relative pl-6">
          <div class="absolute left-2 top-0 bottom-0 w-px bg-skin-line/60"></div>
          <slot name="timeline" />
        </div>
      </div>
    </section>

    <!-- (4) Talk with my thesis (chat-like zone) -->
    <section class="rounded-3xl border border-skin-line/40 bg-skin-card/80 shadow-lg">
      <div class="p-5 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-semibold mb-4">Talk with my thesis</h2>

        <!-- Chat container (neutral background via tokens only; no images) -->
        <div class="rounded-2xl border border-skin-line/50">
          <div class="p-4 sm:p-5">
            <slot name="chat" />
          </div>
        </div>
      </div>
    </section>

    <!-- Back-compat: if you still place content directly without named slots -->
    <section class="prose prose-neutral dark:prose-invert max-w-none mt-10">
      <slot />
    </section>
  </main>
  <Footer />
</Layout>
